<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Amaze UI Admin index Examples</title>
    <meta name="description" content="这是一个 index 页面">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="icon" type="image/png" href="/assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="/assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
    <link rel="stylesheet" href="/assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="/assets/css/amazeui.datatables.min.css"/>
    <link rel="stylesheet" href="/assets/css/app.css">
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/jquery.min-1.2.js"></script>
    <script src="/assets/js/jquery.upload.min.js"></script>
    <link rel="stylesheet" href="/assets/css/upload.css">
    <link rel="stylesheet" href="/assets/css/jquery.dataTables.min.css"/>
    <link rel="stylesheet" href="/assets/css/zTreeStyle.css">
    <script src="/assets/js/jquery.ztree.core.min.js"></script>
    <script src="/assets/js/jquery.ztree.excheck.min.js"></script>
    <SCRIPT type="text/javascript">
        <!--
        var setting = {
            check: {
                enable: true,
                chkStyle: "radio",
                radioType: "all"
            },
            view: {
                dblClickExpand: false
            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            callback: {
                onClick: onClick,
                onCheck: onCheck
            }
        };


        function onClick(e, treeId, treeNode) {
            var zTree = $.fn.zTree.getZTreeObj("treeDemo");
            zTree.checkNode(treeNode, !treeNode.checked, null, true);
            return false;
        }

        function onCheck(e, treeId, treeNode) {
            var zTree = $.fn.zTree.getZTreeObj("treeDemo"),
                nodes = zTree.getCheckedNodes(true),
                v = "";
                var vId = "";
            for (var i=0, l=nodes.length; i<l; i++) {
                v += nodes[i].name + ",";
                vId += nodes[i].id + ",";
            }
            if (v.length > 0 ){
                v = v.substring(0, v.length-1);
                vId = vId.substring(0, vId.length-1);
            }
            var cityObj = $("#citySel");
            cityObj.attr("value", v);
            $("#classify").attr("value", vId);
        }

        function showMenu() {
            var cityObj = $("#citySel");
            var cityOffset = $("#citySel").offset();
            $("#menuContent").css({/*left:cityOffset.left + "px", top:cityOffset.top + cityObj.outerHeight() + "px"*/}).slideDown("fast");

            $("body").bind("mousedown", onBodyDown);
        }
        function hideMenu() {
            $("#menuContent").fadeOut("fast");
            $("body").unbind("mousedown", onBodyDown);
        }
        function onBodyDown(event) {
            if (!(event.target.id == "menuBtn" || event.target.id == "citySel" || event.target.id == "menuContent" || $(event.target).parents("#menuContent").length>0)) {
                hideMenu();
            }
        }

        $(document).ready(function(){
            $.ajax({
                type: "get",
                url: "/merchant/goods/classify/list",
                data: {},
                success: function (data) {
                    $.fn.zTree.init($("#treeDemo"), setting, data);
                }
            });
        });
        //-->
    </SCRIPT>
</head>

<body data-type="widgets">
<script src="/assets/js/theme.js"></script>
<div class="am-g tpl-g">
    <!-- 头部 -->
    <header>
        <!-- logo -->
        <div class="am-fl tpl-header-logo">
            <a href="javascript:;"><img src="/assets/img/logo.png" alt=""></a>
        </div>
        <!-- 右侧内容 -->
        <div class="tpl-header-fluid">
            <!-- 侧边切换 -->
            <div class="am-fl tpl-header-switch-button am-icon-list">
                    <span>

                </span>
            </div>
            <!-- 搜索 -->
            <div class="am-fl tpl-header-search">
                <form class="tpl-header-search-form" action="javascript:;">
                    <button class="tpl-header-search-btn am-icon-search"></button>
                    <input class="tpl-header-search-box" type="text" placeholder="搜索内容...">
                </form>
            </div>
            <!-- 其它功能-->
            <div class="am-fr tpl-header-navbar">
                <ul>
                    <!-- 欢迎语 -->
                    <li class="am-text-sm tpl-header-navbar-welcome">
                        <a href="javascript:;">欢迎你, <span>Amaze UI</span> </a>
                    </li>

                    <!-- 新邮件 -->
                    <li class="am-dropdown tpl-dropdown" data-am-dropdown>
                        <a href="javascript:;" class="am-dropdown-toggle tpl-dropdown-toggle" data-am-dropdown-toggle>
                            <i class="am-icon-envelope"></i>
                            <span class="am-badge am-badge-success am-round item-feed-badge">4</span>
                        </a>
                        <!-- 弹出列表 -->
                        <ul class="am-dropdown-content tpl-dropdown-content">
                            <li class="tpl-dropdown-menu-messages">
                                <a href="javascript:;" class="tpl-dropdown-menu-messages-item am-cf">
                                    <div class="menu-messages-ico">
                                        <img src="/assets/img/user04.png" alt="">
                                    </div>
                                    <div class="menu-messages-time">
                                        3小时前
                                    </div>
                                    <div class="menu-messages-content">
                                        <div class="menu-messages-content-title">
                                            <i class="am-icon-circle-o am-text-success"></i>
                                            <span>夕风色</span>
                                        </div>
                                        <div class="am-text-truncate"> Amaze UI 的诞生，依托于 GitHub 及其他技术社区上一些优秀的资源；Amaze UI
                                            的成长，则离不开用户的支持。
                                        </div>
                                        <div class="menu-messages-content-time">2016-09-21 下午 16:40</div>
                                    </div>
                                </a>
                            </li>

                            <li class="tpl-dropdown-menu-messages">
                                <a href="javascript:;" class="tpl-dropdown-menu-messages-item am-cf">
                                    <div class="menu-messages-ico">
                                        <img src="/assets/img/user02.png" alt="">
                                    </div>
                                    <div class="menu-messages-time">
                                        5天前
                                    </div>
                                    <div class="menu-messages-content">
                                        <div class="menu-messages-content-title">
                                            <i class="am-icon-circle-o am-text-warning"></i>
                                            <span>禁言小张</span>
                                        </div>
                                        <div class="am-text-truncate"> 为了能最准确的传达所描述的问题， 建议你在反馈时附上演示，方便我们理解。</div>
                                        <div class="menu-messages-content-time">2016-09-16 上午 09:23</div>
                                    </div>
                                </a>
                            </li>
                            <li class="tpl-dropdown-menu-messages">
                                <a href="javascript:;" class="tpl-dropdown-menu-messages-item am-cf">
                                    <i class="am-icon-circle-o"></i> 进入列表…
                                </a>
                            </li>
                        </ul>
                    </li>

                    <!-- 新提示 -->
                    <li class="am-dropdown" data-am-dropdown>
                        <a href="javascript:;" class="am-dropdown-toggle" data-am-dropdown-toggle>
                            <i class="am-icon-bell"></i>
                            <span class="am-badge am-badge-warning am-round item-feed-badge">5</span>
                        </a>

                        <!-- 弹出列表 -->
                        <ul class="am-dropdown-content tpl-dropdown-content">
                            <li class="tpl-dropdown-menu-notifications">
                                <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                    <div class="tpl-dropdown-menu-notifications-title">
                                        <i class="am-icon-line-chart"></i>
                                        <span> 有6笔新的销售订单</span>
                                    </div>
                                    <div class="tpl-dropdown-menu-notifications-time">
                                        12分钟前
                                    </div>
                                </a>
                            </li>
                            <li class="tpl-dropdown-menu-notifications">
                                <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                    <div class="tpl-dropdown-menu-notifications-title">
                                        <i class="am-icon-star"></i>
                                        <span> 有3个来自人事部的消息</span>
                                    </div>
                                    <div class="tpl-dropdown-menu-notifications-time">
                                        30分钟前
                                    </div>
                                </a>
                            </li>
                            <li class="tpl-dropdown-menu-notifications">
                                <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                    <div class="tpl-dropdown-menu-notifications-title">
                                        <i class="am-icon-folder-o"></i>
                                        <span> 上午开会记录存档</span>
                                    </div>
                                    <div class="tpl-dropdown-menu-notifications-time">
                                        1天前
                                    </div>
                                </a>
                            </li>


                            <li class="tpl-dropdown-menu-notifications">
                                <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                    <i class="am-icon-bell"></i> 进入列表…
                                </a>
                            </li>
                        </ul>
                    </li>

                    <!-- 退出 -->
                    <li class="am-text-sm">
                        <a href="javascript:;">
                            <span class="am-icon-sign-out"></span> 退出
                        </a>
                    </li>
                </ul>
            </div>
        </div>

    </header>
    <!-- 风格切换 -->
    <div class="tpl-skiner">
        <div class="tpl-skiner-toggle am-icon-cog">
        </div>
        <div class="tpl-skiner-content">
            <div class="tpl-skiner-content-title">
                选择主题
            </div>
            <div class="tpl-skiner-content-bar">
                <span class="skiner-color skiner-white" data-color="theme-white"></span>
                <span class="skiner-color skiner-black" data-color="theme-black"></span>
            </div>
        </div>
    </div>
    <!-- 侧边导航栏 -->
    <div class="left-sidebar">
        <!-- 用户信息 -->
        <div class="tpl-sidebar-user-panel">
            <div class="tpl-user-panel-slide-toggleable">
                <div class="tpl-user-panel-profile-picture">
                    <img src="/assets/img/user04.png" alt="">
                </div>
                <span class="user-panel-logged-in-text">
              <i class="am-icon-circle-o am-text-success tpl-user-panel-status-icon"></i>
              禁言小张
          </span>
                <a href="javascript:;" class="tpl-user-panel-action-link"> <span class="am-icon-pencil"></span> 账号设置</a>
            </div>
        </div>


        <!-- 菜单 -->
        <ul class="sidebar-nav">
            <li class="sidebar-nav-heading">Components <span class="sidebar-nav-heading-info"> 附加组件</span></li>
            <li class="sidebar-nav-link">
                <a href="index.html">
                    <i class="am-icon-home sidebar-nav-link-logo"></i> 首页
                </a>
            </li>
            <li class="sidebar-nav-link">
                <a href="tables.html">
                    <i class="am-icon-table sidebar-nav-link-logo"></i> 表格
                </a>
            </li>
            <li class="sidebar-nav-link">
                <a href="calendar.html">
                    <i class="am-icon-calendar sidebar-nav-link-logo"></i> 日历
                </a>
            </li>
            <li class="sidebar-nav-link">
                <a href="form.html">
                    <i class="am-icon-wpforms sidebar-nav-link-logo"></i> 表单

                </a>
            </li>
            <li class="sidebar-nav-link">
                <a href="chart.html">
                    <i class="am-icon-bar-chart sidebar-nav-link-logo"></i> 图表

                </a>
            </li>

            <li class="sidebar-nav-heading">Page<span class="sidebar-nav-heading-info"> 常用页面</span></li>
            <li class="sidebar-nav-link">
                <a href="javascript:;" class="sidebar-nav-sub-title active">
                    <i class="am-icon-table sidebar-nav-link-logo"></i> 数据列表
                    <span class="am-icon-chevron-down am-fr am-margin-right-sm sidebar-nav-sub-ico sidebar-nav-sub-ico-rotate"></span>
                </a>
                <ul class="sidebar-nav sidebar-nav-sub" style="display: block;">
                    <li class="sidebar-nav-link">
                        <a href="brand.html">
                            <span class="am-icon-angle-right sidebar-nav-link-logo"></span> 文字列表
                        </a>
                    </li>

                    <li class="sidebar-nav-link">
                        <a href="goods.html" class="sub-active">
                            <span class="am-icon-angle-right sidebar-nav-link-logo"></span> 图文列表
                        </a>
                    </li>
                </ul>
            </li>
            <li class="sidebar-nav-link">
                <a href="sign-up.html">
                    <i class="am-icon-clone sidebar-nav-link-logo"></i> 注册
                    <span class="am-badge am-badge-secondary sidebar-nav-link-logo-ico am-round am-fr am-margin-right-sm">6</span>
                </a>
            </li>
            <li class="sidebar-nav-link">
                <a href="login.html">
                    <i class="am-icon-key sidebar-nav-link-logo"></i> 登录
                </a>
            </li>
            <li class="sidebar-nav-link">
                <a href="404.html">
                    <i class="am-icon-tv sidebar-nav-link-logo"></i> 404错误
                </a>
            </li>

        </ul>
    </div>


    <!-- 内容区域 -->
    <div class="tpl-content-wrapper">
        <div class="row-content am-cf">
            <div class="row">
                <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
                    <div class="widget am-cf">
                        <div class="widget-head am-cf">
                            <div class="widget-title  am-cf">文章列表</div>


                        </div>
                        <div class="widget-body  am-fr">

                            <div class="am-u-sm-12 am-u-md-6 am-u-lg-6">
                                <div class="am-form-group">
                                    <div class="am-btn-toolbar">
                                        <div class="am-btn-group am-btn-group-xs">
                                            <button type="button" class="am-btn am-btn-default am-btn-success"
                                                    onclick="showAdd()"><span class="am-icon-plus"></span> 新增
                                            </button>
                                            <button type="button" class="am-btn am-btn-default am-btn-primary"
                                                    onclick="showAdd()"><span class="am-icon-navicon"></span> 编辑
                                            </button>
                                            <button type="button" class="am-btn am-btn-default am-btn-warning"><span
                                                class="am-icon-archive"></span> 下架
                                            </button>
                                            <button type="button" class="am-btn am-btn-default am-btn-secondary"><span
                                                    class="am-icon-save"></span> 上架
                                            </button>
                                            <button type="button" class="am-btn am-btn-default am-btn-danger"><span
                                                    class="am-icon-trash-o"></span> 删除
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="am-u-sm-12 am-u-md-6 am-u-lg-3">
                                <div class="am-form-group tpl-table-list-select">
                                    <select data-am-selected="{btnSize: 'sm'}" name="enabled" data-am-selected placeholder="请选择上下架状态" >
                                        <option selected value=""></option>
                                        <option value="1">下架</option>
                                        <option value="0">上架</option>
                                    </select>
                                </div>
                            </div>
                            <div class="am-u-sm-12 am-u-md-12 am-u-lg-3">
                                <div class="am-input-group am-input-group-sm tpl-form-border-form cl-p">
                                    <input type="text" class="am-form-field " id="goodsName" placeholder="请输入商品名称">
                                    <span class="am-input-group-btn">
            <button class="am-btn  am-btn-default am-btn-success tpl-table-list-field am-icon-search"
                    type="button" id="search"></button>
          </span>
                                </div>
                            </div>

                            <div class="am-u-sm-12">
                                <table width="100%" class="row-border am-table am-table-compact  tpl-table-black" id="goods-table">
                                    <thead>
                                    <tr>
                                        <th><input id="checkAll" class="checkAll" type="checkbox" value=""></th>
                                        <th>商品缩略图</th>
                                        <th>商品名称</th>
                                        <th>商品卖价</th>
                                        <th>状态</th>
                                        <th>审核结果</th>
                                        <th>上下架状态</th>
                                    </tr>
                                    </thead>

                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


</div>
<script src="/assets/js/amazeui.min.js"></script>
<script src="/assets/js/app.js"></script>
<div class="am-modal am-modal-no-btn am-u-sm-12" id="goods-modal">
    <div class="am-modal-dialog">
        <div class="am-modal-bd">
            <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
                <div class="widget am-cf">
                    <div class="widget-head am-cf">
                        <div class="widget-title am-fl">添加商品</div>
                    </div>
                    <div class="widget-body am-fr">

                        <form class="am-form tpl-form-line-form" action="/merchant/goods/create" method="post"
                              data-am-validator onsubmit="actionAdd()">
                            <div class="am-form-group">
                                <label for="good-name" class="am-u-sm-3 am-form-label">商品名称</label>
                                <div class="am-u-sm-9">
                                    <input type="text" class="tpl-form-input" id="good-name" name="name"
                                           placeholder="请输入商品名称" required>
                                </div>
                            </div>

                           <!-- <div class="am-form-group">
                                <label class="am-u-sm-3 am-form-label">生产日期 </label>
                                <div class="am-u-sm-9">
                                    <input type="text" class="am-form-field tpl-form-no-bg" placeholder="生产日期"
                                           data-am-datepicker="" readonly="" required name="">
                                </div>
                            </div>-->
                            <div class="am-form-group">
                                <label for="producer" class="am-u-sm-3 am-form-label">商品生产商</label>
                                <div class="am-u-sm-9">
                                    <input type="text" class="tpl-form-input" id="producer" name="producer"
                                           placeholder="请输入商品生产商" required>
                                </div>
                            </div>
                            <div class="am-form-group">
                                <label class="am-u-sm-3 am-form-label">所属品牌 </label>
                                <div class="am-u-sm-9">
                                    <select data-am-selected="{searchBox: 1}" style="display: none;" required
                                            name="brandId" data-am-selected placeholder="请选择所属品牌">
                                        <option value=""></option>
                                        {{#brands}}
                                        <option value={{id}}>{{name}}</option>
                                        {{/brands}}
                                    </select>

                                </div>
                            </div>

                            <div class="am-form-group">
                                <label class="am-u-sm-3 am-form-label">封面图 </label>
                                <div class="am-u-sm-9">
                                    <div class="case">
                                        <div class="upload" id="case" data-num="10" data-type="png,jpg,jpeg,gif" action="/merchant/file/upload"
                                             data-name="picture" ></div>
                                    </div>
                                    <script type="text/javascript">
                                        $(function(){
                                            $("#case").upload(
                                                //该函数为点击放大镜的回调函数，如没有该函数，则不显示放大镜
                                                function(_this,data){
                                                    console.log(data)
                                                }
                                            );
                                        })
                                    </script>

                                </div>
                            </div>

                            <div class="am-form-group">
                                <label class="am-u-sm-3 am-form-label">添加分类 </label>
                                <div class="am-u-sm-9">
                                    <ul class="list">
                                        <li><input id="citySel" type="text" readonly  style="width:100%;"
                                                   name="classifyName" onclick="showMenu()"/></li>
                                        <input id="classify" type="hidden"  style="width:100%;"
                                               name="classifyId" />
                                    </ul>
                                    <div id="menuContent" class="menuContent am-vertical-align-middle" style="display:none;margin-top:0;width:100%;border:1px solid #DBDBDB">
                                        <ul id="treeDemo" class="ztree" style="margin-top:0; width:100%;"></ul>
                                    </div>
                                </div>
                            </div>
                            <div class="am-form-group">
                                <label for="price" class="am-u-sm-3 am-form-label">商品卖价</label>
                                <div class="am-u-sm-9">
                                    <input class="tpl-form-input" id="price" name="price" type="number"
                                           placeholder="请输入商品卖价" required>
                                </div>
                            </div>
                            <div class="am-form-group">
                                <label for="cost_price" class="am-u-sm-3 am-form-label">商品进价</label>
                                <div class="am-u-sm-9">
                                    <input class="tpl-form-input" id="cost_price" name="costPrice" type="number"
                                           placeholder="请输入商品进价" required>
                                </div>
                            </div>
                            <div class="am-form-group">
                                <label class="am-u-sm-3 am-form-label">商品重量</label>
                                <div class="am-u-sm-9">
                                    <input class="tpl-form-input" id="weight" name="weight" type="number"
                                           placeholder="请输入商品重量" required><small>单位:kg(千克)</small>
                                </div>
                            </div>
                            <div class="am-form-group">
                                <label for="describe" class="am-u-sm-3 am-form-label">商品描述</label>
                                <div class="am-u-sm-9">
                                    <textarea class="" rows="5" id="describe" placeholder="请输入商品描述" name="describe"
                                              required></textarea>
                                </div>
                            </div>

                            <div class="am-form-group">
                                <div class="am-u-sm-9 am-u-sm-push-3">
                                    <button type="submit" class="am-btn am-btn-primary tpl-btn-bg-color-success "
                                            id="add">添加
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
<script src="/assets/js/amazeui.min.js"></script>
<script src="/assets/js/amazeui.datatables.min.js"></script>
<script src="/assets/js/dataTables.responsive.min.js"></script>
<script src="/assets/js/app.js"></script>
<script src="/assets/js/dataTables.select.min.js"></script>
<script src="/assets/js/amazeui.dialog.min.js"></script>
<script>
    var table = $('#goods-table').DataTable({
        ajax: {
            url: '/merchant/goods/list',
            type: 'get'
        }
        ,
        dataSrc: "",
        ordering:false,
        processing: true,
        serverSide: true,  //启用服务器端分页
        lengthChange: true,//是否允许用户自定义显示页数据量
        lengthMenu: [
            5, 10, 15, 30, 50
        ],
        pageLength: 5,
        columns: [
            {data: 'id',render:function (data) {
                    return "<input type='checkbox' onclick = childclick() name='ckb-jobid' value='"+data+"' >";
                }},
            {
                data: 'picture', render: function (data, type, row) {
                    return "<img src='/merchant/file/"+data+ "' class='tpl-table-line-img'>";
                }
            },
            {data: 'name'},
            {data: 'price'},
            {data: 'status', render: function (data) {
                    if (data == 0){
                        return "待审核";
                    } else if (data == 1) {
                        return "审核成功";
                    }else{
                        return "审核失败";
                    }
                }
            },
            {data:'details'},
            {data: 'enabled', render: function (data) {
                    if (data){
                        return "下架";
                    }else{
                        return "上架";
                    }
                }
            }
        ]
    });

    $('#checkAll').on('click', function () {
        alert(this.checked)
        if (this.checked) {
            $(this).attr('checked','checked')
            $("input[name='ckb-jobid']").each(function () {
                this.checked = true;
            });
        } else {
            $(this).removeAttr('checked')
            $("input[name='ckb-jobid']").each(function () {
                this.checked = false;
            });
        }
    });

    function childclick(){
        if ($(this).is(":checked") == false) {
            $("#checkAll").prop("checked", false);
        }
    }
    function showAdd() {
        $('#goods-modal').modal('open');
    }

    function actionAdd() {

        //     return false;
        // }
        var pictures = $('input[name="picture"]');
        if (pictures.val() === ""){
            // if (filesName.length < 1 || filesName.length > 4){
            AMUI.dialog.alert({ title: '错误提示', content: '至少上传一张图片', onConfirm: function() { console.log('close'); } });
            return false;
        }
        return true;
    }
    $("#search").on("click",function(){
        //自己定义的搜索框，可以是时间控件，或者checkbox 等等
        var args1 = $("#enabled").val();
        var args2 = $("#goodsName").val();
        table
            .column(6)
            .search(args1)
            .column(4)
            .search(args2)
            .draw();
    });
</script>
</html>